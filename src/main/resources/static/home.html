<!DOCTYPE html>
<html class="x-admin-sm">
<head>
    <meta charset="UTF-8">
    <title>首页</title>
    <meta name="renderer" content="webkit">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width,user-scalable=yes, minimum-scale=0.4, initial-scale=0.8,target-densitydpi=low-dpi" />
    <link rel="stylesheet" href="./css/font.css">
    <link rel="stylesheet" href="./lib/layui/css/layui.css"  media="all">
    <link rel="stylesheet" href="./css/xadmin.css">

    <script type="text/javascript" src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript" src="./lib/layui/layui.js" charset="utf-8"></script>
    <script type="text/javascript" src="./js/xadmin.js"></script>
    <script type="text/javascript" src="./js/cookie.js"></script>

<!--    <script type="text/javascript" src="../static/js/echarts.min.js"></script>-->
    <script src="https://cdn.bootcss.com/echarts/4.2.1-rc1/echarts.min.js"></script>
</head>
<body>
<div class="x-nav">
      <span class="layui-breadcrumb">
        <a>首页</a>
      </span>
    <a class="layui-btn layui-btn-small" style="line-height:1.6em;margin-top:3px;float:right" href="javascript:location.replace(location.href);" title="刷新">
        <i class="layui-icon" style="line-height:30px">刷新</i></a>
</div>

<fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
    <legend>数量统计</legend>
</fieldset>
<div style="padding-top: 20px;padding-left: 150px;font-size: 15px">
    <div class="layui-row layui-col-space30">
            <div class="layui-col-md2">
                <div class="layui-card" style="background-color: #F2F2F2;">
                    <div id="product" class="layui-card-body">
                        <!--作品数量<br>
                        435434<br><hr>
                        今日新增:423<br>
                        本周新增:674<br>
                        本月新增:432-->
                    </div>
                </div>
            </div>
            <div class="layui-col-md2">
                <div class="layui-card" style="background-color: #F2F2F2;">
                    <div id="author" class="layui-card-body">
                       <!-- 作者数量<br>
                        435434<br><hr>
                        今日新增:423<br>
                        本周新增:674<br>
                        本月新增:432-->
                    </div>
                </div>
            </div>
            <div class="layui-col-md2">
                <div class="layui-card" style="background-color: #F2F2F2;">
                    <div id="referrals" class="layui-card-body">
                        <!--推荐人数量<br>
                        435434<br><hr>
                        今日新增:423<br>
                        本周新增:674<br>
                        本月新增:432-->
                    </div>
                </div>
            </div>
            <div class="layui-col-md2">
                <div class="layui-card" style="background-color: #F2F2F2;">
                    <div id="user" class="layui-card-body">
                        <!--用户数量<br>
                        435434<br><hr>
                        今日新增:423<br>
                        本周新增:674<br>
                        本月新增:432-->
                    </div>
                </div>
            </div>
            <div class="layui-col-md2">
                <div class="layui-card" style="background-color: #F2F2F2;">
                    <div id="order" class="layui-card-body">
                       <!-- 订单数量<br>
                        435434<br><hr>
                        今日新增:423<br>
                        本周新增:674<br>
                        本月新增:432-->
                    </div>
                </div>
            </div>
    </div>
</div>
<fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
    <legend>实时数据</legend>
</fieldset>
<div style="padding-top: 20px;padding-left: 150px;font-size: 15px">
    <div class="layui-row layui-col-space30" style="text-align: center;">
            <div class="layui-col-md2" >
                <div class="layui-card" style="background-color: #F2F2F2;">
                    <div id="sales" class="layui-card-body">
                        <!--今日销售额(元)<br>
                        435434<br><hr>
                        昨日:432.00-->
                    </div>
                </div>
            </div>
            <div class="layui-col-md2">
                <div class="layui-card" style="background-color: #F2F2F2;">
                    <div id="order1" class="layui-card-body">
                        <!--今日支付订单数<br>
                        435434<br><hr>
                        昨日:237-->
                    </div>
                </div>
            </div>
            <div class="layui-col-md2">
                <div class="layui-card" style="background-color: #F2F2F2;">
                    <div id="order0" class="layui-card-body">
                        <!--今日下单用户<br>
                        43<br><hr>
                        昨日:23-->
                    </div>
                </div>
            </div>
            <div class="layui-col-md2">
                <div class="layui-card" style="background-color: #F2F2F2;">
                    <div class="layui-card-body">
                        今日访问量<br>
                        23<br><hr>
                        昨日:21
                    </div>
                </div>
            </div>

    </div>
</div>
<fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
    <legend>图形走势</legend>
</fieldset>
<div style="padding-top: 50px;padding-left: 120px;">
    <!-- 为ECharts准备一个具备大小（宽高）的Dom -->
    <div id="main" style="width: 900px;height:500px;"></div>
</div>

<script src="js/main.js"></script>
<script type="text/javascript">
    // 基于准备好的dom，初始化echarts实例
    var myChart = echarts.init(document.getElementById('main'));

    // $.ajax({
    //     url:'../home/getAllnum',
    //     type:'post',
    // })
    //     .done(function() {

            // 指定图表的配置项和数据
            option = {
                title: {
                    text: '走势图'
                },
                tooltip: {
                    trigger: 'axis'
                },
                legend: {
                    data: ['交易额', '订单量']
                },
                grid: {
                    left: '3%',
                    right: '4%',
                    bottom: '3%',
                    containLabel: true
                },
                toolbox: {
                    feature: {
                        saveAsImage: {}
                    }
                },
                xAxis: {
                    type: 'category',
                    boundaryGap: false,
                    data: ['2019-11-09', '2019-11-10', '2019-11-11', '2019-11-12', '2019-11-13', '2019-11-14', '2019-11-15']
                },
                yAxis: {
                    type: 'value'
                },
                series: [
                    {
                        name: '交易额',
                        type: 'line',
                        stack: '总量',
                        data: [120, 132, 101, 134, 90, 230, 210]
                    },
                    {
                        name: '订单量',
                        type: 'line',
                        stack: '总量',
                        data: [220, 182, 191, 234, 290, 330, 310]
                    },

                ]
            };
            // 使用刚指定的配置项和数据显示图表。
            myChart.setOption(option);
        // }
        // .fail(function() {
        //         console.log("error");
        //     });

    //数量统计
    $(function(){
        get_num_info();
        get_realtime_info();
    });

    function get_num_info(){
        $.ajax({
            url:'../home/getAllnum',
            type:'post',
            success:function(data){
                // alert("UserServlet:data"+data);
                console.log(data);
                show_product_info(data.extend.list.product);
                show_author_info(data.extend.list.author);
                show_referrals_info(data.extend.list.referrals);
                show_user_info(data.extend.list.user);
                show_order_info(data.extend.list.order);

            },
            error:function () {
                alert("查询数量统计异常!");
            }
        });
    }

    function show_product_info(product) {
        // alert("作品总数:"+product.num+"==今日新增:"+product.today+"==本周新增:"+product.week+"==本月新增:"+product.month)
        //清空之前的作品数量数据
        $('#product').empty();
        //作品数量展示
        // $('#product').innerHTML='作品数量<br>'+product.num+'<br><hr>今日新增:'+product.today+'<br>本周新增:'+product.week+'<br>本月新增:'+product.month;
        var pro = document.getElementById("product");
        pro.innerHTML='作品数量<br>'+product.num+'<br><hr>今日新增:'+product.today+'<br>本周新增:'+product.week+'<br>本月新增:'+product.month;

    }
    function show_author_info(product) {
        // alert("作品总数:"+product.num+"==今日新增:"+product.today+"==本周新增:"+product.week+"==本月新增:"+product.month)
        //清空之前的作品数量数据
        $('#author').empty();
        //作品数量展示
        // $('#product').innerHTML='作品数量<br>'+product.num+'<br><hr>今日新增:'+product.today+'<br>本周新增:'+product.week+'<br>本月新增:'+product.month;
        var pro = document.getElementById("author");
        pro.innerHTML='作者数量<br>'+product.num+'<br><hr>今日新增:'+product.today+'<br>本周新增:'+product.week+'<br>本月新增:'+product.month;

    }
    function show_referrals_info(product) {
        // alert("作品总数:"+product.num+"==今日新增:"+product.today+"==本周新增:"+product.week+"==本月新增:"+product.month)
        //清空之前的作品数量数据
        $('#referrals').empty();
        //作品数量展示
        // $('#product').innerHTML='作品数量<br>'+product.num+'<br><hr>今日新增:'+product.today+'<br>本周新增:'+product.week+'<br>本月新增:'+product.month;
        var pro = document.getElementById("referrals");
        pro.innerHTML='推荐人数量<br>'+product.num+'<br><hr>今日新增:'+product.today+'<br>本周新增:'+product.week+'<br>本月新增:'+product.month;

    }
    function show_user_info(product) {
        // alert("作品总数:"+product.num+"==今日新增:"+product.today+"==本周新增:"+product.week+"==本月新增:"+product.month)
        //清空之前的作品数量数据
        $('#user').empty();
        //作品数量展示
        // $('#product').innerHTML='作品数量<br>'+product.num+'<br><hr>今日新增:'+product.today+'<br>本周新增:'+product.week+'<br>本月新增:'+product.month;
        var pro = document.getElementById("user");
        pro.innerHTML='用户数量<br>'+product.num+'<br><hr>今日新增:'+product.today+'<br>本周新增:'+product.week+'<br>本月新增:'+product.month;

    }
    function show_order_info(product) {
        // alert("作品总数:"+product.num+"==今日新增:"+product.today+"==本周新增:"+product.week+"==本月新增:"+product.month)
        //清空之前的作品数量数据
        $('#order').empty();
        //作品数量展示
        // $('#product').innerHTML='作品数量<br>'+product.num+'<br><hr>今日新增:'+product.today+'<br>本周新增:'+product.week+'<br>本月新增:'+product.month;
        var pro = document.getElementById("order");
        pro.innerHTML='订单数量<br>'+product.num+'<br><hr>今日新增:'+product.today+'<br>本周新增:'+product.week+'<br>本月新增:'+product.month;

    }
    function get_realtime_info(){
        $.ajax({
            url:'../home/getRealtime',
            type:'post',
            success:function(data){
                // alert("UserServlet:data"+data);
                console.log(data);
                show_sales_info(data.extend.list.sales);
                show_order1_info(data.extend.list.order1);
                show_order0_info(data.extend.list.order0);
            },
            error:function () {
                alert("查询实时数据异常!");
            }
        });
    }
    function show_sales_info(sales) {
        // alert("作品总数:"+product.num+"==今日新增:"+product.today+"==本周新增:"+product.week+"==本月新增:"+product.month)
        //清空之前的作品数量数据
        $('#sales').empty();
        //作品数量展示
        // $('#product').innerHTML='作品数量<br>'+product.num+'<br><hr>今日新增:'+product.today+'<br>本周新增:'+product.week+'<br>本月新增:'+product.month;
        var pro = document.getElementById("sales");
        pro.innerHTML='今日销售额(元)<br>'+sales.today +'<br><hr> 昨日:'+sales.yesterday;
    }
    function show_order1_info(sales) {
        // alert("作品总数:"+product.num+"==今日新增:"+product.today+"==本周新增:"+product.week+"==本月新增:"+product.month)
        //清空之前的作品数量数据
        $('#order1').empty();
        //作品数量展示
        // $('#product').innerHTML='作品数量<br>'+product.num+'<br><hr>今日新增:'+product.today+'<br>本周新增:'+product.week+'<br>本月新增:'+product.month;
        var pro = document.getElementById("order1");
        pro.innerHTML='今日支付订单数<br>'+sales.today +'<br><hr> 昨日:'+sales.yesterday;
    }
    function show_order0_info(sales) {
        // alert("作品总数:"+product.num+"==今日新增:"+product.today+"==本周新增:"+product.week+"==本月新增:"+product.month)
        //清空之前的作品数量数据
        $('#order0').empty();
        //作品数量展示
        // $('#product').innerHTML='作品数量<br>'+product.num+'<br><hr>今日新增:'+product.today+'<br>本周新增:'+product.week+'<br>本月新增:'+product.month;
        var pro = document.getElementById("order0");
        pro.innerHTML='今日下单用户<br>'+sales.today +'<br><hr> 昨日:'+sales.yesterday;
    }
</script>
</body>
</html>